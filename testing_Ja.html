<script>
  // initialize the map
  var map = L.map('map').setView([40, -89], 4);
  
  // create a markers layer group
  var markers = L.layerGroup().addTo(map);

  // loop through the cities data and add a marker for each city
  cities.features.forEach(city => {
    const marker = L.marker([city.geometry.coordinates[1], city.geometry.coordinates[0]]);
    marker.on('mouseover', e => {
      // highlight the marker when hovered over
      e.target.setStyle({
        weight: 5,
        color: '#666',
        dashArray: '',
        fillOpacity: 0.7
      });
    });
    marker.on('mouseout', e => {
      // reset the marker style when mouseout
      markers.resetStyle(e.target);
    });
    marker.addTo(markers);
  });

  // load a tile layer
  L.esri.basemapLayer('Streets').addTo(map);

  // create a popup for the map click event
  var popup = L.popup();
  function onMapClick(e) {
      popup
          .setLatLng(e.latlng)
          .setContent("You clicked the map at " + e.latlng.toString())
          .openOn(map);
  }
  map.on('click', onMapClick);

  // create an info control for the map
  var info = L.control();
  info.onAdd = function (map) {
      this._div = L.DomUtil.create('div', 'info'); // create a div with a class "info"
      this.update();
      return this._div;
  };

  // update the info control when a city marker is hovered over
  info.update = function (props) {
      this._div.innerHTML = '<h4>Population around park</h4>' +  (props ?
          '<b>' + props.population + '%</b><br />' + props.name
          : 'Hover over a city');
  };
  info.addTo(map);

  // define the highlightFeature function for the city markers
  function highlightFeature(e) {
    var layer = e.target;
    layer.setStyle({
        weight: 3,
        color: '#00ffff',
        dashArray: '',
        fillOpacity: 0.9
    });
    if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
      layer.bringToFront();
    }
    info.update(layer.feature.properties);
  }

  // define the resetHighlight function for the city markers
  function resetHighlight(e) {
    markers.resetStyle(e.target);
    info.update();
  }

  // define the zoomToFeature function for the city markers
  function zoomToFeature(e) {
    map.fitBounds(e.target.getBounds());
  }

  // add the city markers to the map and define their interaction functions
  L.geoJSON(cities, {
    onEachFeature: function(feature, layer) {
      layer.on({
        mouseover: highlightFeature,
        mouseout: resetHighlight,
        click: zoomToFeature
      });
    }
  }).addTo(map);
</script>
